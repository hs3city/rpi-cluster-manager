{% extends "base.html" %}

{% macro claim_btn(mac_address) %}
        <button type="submit" name="action" value="claim"
                class="btn btn-sm btn-outline-primary">claim
        </button>
{% endmacro %}
{% macro unclaim_btn(mac_address) %}
        <button type="submit" name="action" value="unclaim"
                class="btn btn-sm btn-outline-danger">unclaim
        </button>
        <button type="submit" name="action" value="change_hostname"
                class="btn btn-sm btn-outline-danger">change hostname
        </button>
{% endmacro %}
{% macro user_wiki(user) -%}
    <a href="//wiki.hs3.pl/ludzie/{{ user.username }}">{{ user.username }}</a>
{% endmacro %}
{% macro flag_badge(flag, flag_name) -%}
    {% if flag is sameas True %}
        <span class="badge badge-primary">{{ flag_name }}</span>
    {% endif %}
{% endmacro %}

{% macro device_row(device, owner='') -%}
    <div>
        <form action="/device/{{ device.mac_address }}" method="post">
            <input type="hidden" id="db_state_hash" name="db_state_hash" value="{{ db_state_hash }}">
            <a href="/device/{{ device.mac_address }}">{{ device.mac_address }}</a>
            <span>{{ device.ip }}</span>
            <input type="text" name="hostname" value="{{ device.hostname }}">
            <span>{{ owner }}</span>
        </form>
    </div>
{%- endmacro %}


{% block content %}
    {% if current_user.is_authenticated %}
        <div class="table-responsive">
        <h2>My Devices</h2>
            {% for device in my_devices -%}
                {{ device_row(device, owner=unclaim_btn(device.mac_address)) }}
            {%- endfor %}
        </div>
        <div>
        <h2>Unclaimed devices</h2>
            {% for device in unclaimed -%}
                {{ device_row(device, owner=claim_btn(device.mac_address)) }}
            {%- endfor %}
        </div>
    {% endif %}

{% endblock %}
